<!doctype html>
<html>
  <head>
    <meta charset=utf-8>
    <link rel=stylesheet href=stylesheets/preso.css />

    <!-- Used for dynamic window resizing -->
    <style id=style type=text/css></style>

    <title>Enjoying the View with Live Bindings</title>
    <script src=javascript/modernizr.custom.30668.js></script>
  </head>
  <body class=bitovi>

    <div id=wrap>

      <section id=s1>
        <h1>Enjoying the View<br />with Live Bindings</h1>
        <p class="center">
          By <a target="_blank" href="http://twitter.com/ralphholzmann">@ralphholzmann</a>
        </p>
      </section>

      <section id="s2">
        <h2>Ralph Holzmann</h2>
        <ul>
          <li>JavaScript Developer at <del>Jupiter</del> <ins><a target=_blank href="http://bitovi.com/">Bitovi</a></ins>
            <ul>
              <li>
                Creators of <a target=_blank href="http://canjs.us">CanJS</a>, 
                <small><a target=_blank href=http://javascriptmvc.com>JavaScriptMVC</a></small>,
                <small><small>Steal</small></small>, 
                <small><small><small>FuncUnit</small></small></small>,
                <small><small><small><small>DocumentJs</small></small></small></small>
              </li>
            </ul>
          </li>
          <li>Fond du Lac, WI</li>
          <li>Co-author of <a target="_blank" href="https://github.com/SlexAxton/yepnope.js">yepnope.js</a></li>
          <li>Creator of Send to Dropbox</li>
          <li>Husband and father of <del>two</del> <ins>three</ins> boys</li>
        </ul>
      </section>

      <section id="s3">
        <h2>Babbys</h2>
        <img class=center src="imgs/family.jpg" width="80%" style="display:block; margin: 0 auto" />
      </section>

      <section id="s4">
        <h2>Live Bindings</h2>
        <ul>
          <li>Motivation</li>
          <li>What is it?</li>
          <li>Implementing it correctly</li>
          <li>Cases to Cover</li>
        </ul>
      </section>

      <section>
        <h2>Sample EJS Template</h2>
        <pre class="brush: js">// profile.ejs
&lt;h2&gt;&lt;%= user.name %&gt;&lt;/h2&gt;
&lt;small&gt;
  A &lt;%= user.occupation %&gt;
  from &lt;%= user.location %&gt;.
&lt;/small&gt;</pre>
        <pre class="brush: js">// Example user data
var user = {
  name : "Alex",
  occupation : "Labs Engineer",
  location : "TX",
}
</pre>
      </section>


      <section>
        <h2>Example in CanJS</h2>
        <div style=font-size:90%>
        <pre class="brush: js">var profileController = can.Control({

  init : function() {

    can.view( "profile.ejs", {
      user : this.options.user
    }).then( this.proxy( function( fragment ) {
      this.element.append( fragment );
    }));

  }

});

var controller = new profileController("#foo", {
  user : user
});

</pre>
</div>
      </section>

      <section>
        <h2>Output</h2>
        <pre class="brush: html">

&lt;div id="foo"&gt;
  &lt;h2&gt;Alex&lt;/h2&gt;
  &lt;small&gt;
    A Labs Engineer
    from TX.
  &lt;/small&gt;
&lt;/div&gt;
</pre>
      </section>

      <section>
        <h2>Example in CanJS (continued)</h2>
        <pre class="brush: js">// Later on... perhaps in another controller
user.occupation = "Gingerbread Man";

// This sucks...
profile.init();

</pre>
      </section>

      <section>
        <h2>Observables to the Rescue</h2>
        <pre class="brush: js">// Example user data
var user = new can.Observe({
  name : "Alex",
  occupation : "Labs Engineer",
  location : "TX",
});

// Instantiate
var profile = new profileController("#profile", {
  user : user
});

// Later on...
user.attr("occupation", "Gingerbread Man");

</pre>
      </section>

      <section>
        <h2>Example in CanJS</h2>
        <div style=font-size:90%>
        <pre class="brush: js">var profileController = can.Control({

  init : function() {
    this.renderView();
  },

  renderView : function() {
    can.view( "profile.ejs", {
      user : this.options.user
    }).then( this.proxy( function( fragment ) {
      this.element.append( fragment );
    }));
  },

  "{user} change" : function() {
    this.renderView();
  }

});
</pre>
</section>

<section>
<h2>This also sucks.</h2>
<ul>
  <li>Re-renders the whole template</li>
  <li>Manual <code>function</code> calling to update the view.
  <pre class="brush: js">"{user} change" : function() {
    this.renderView();
}</pre>
  </li>
  <li>What if the view could be aware of the changes to the data?</li>

</ul>

</section>


      <section>
        <h2>Sample EJS Template</h2>
        <pre class="brush: js">// profile.ejs
&lt;h2&gt;&lt;%= user.attr("name") %&gt;&lt;/h2&gt;
&lt;small&gt;
  A &lt;%= user.attr("occupation") %&gt;
  from &lt;%= user.attr("location") %&gt;.
&lt;/small&gt;</pre>
</pre>

</section>



      <section class="center">
        <h2>Example in CanJS (so much win)</h2>
        <pre class="brush: js">var profileController = can.Control({

  init : function() {
    can.view( "profile.ejs", {
      user : this.options.user
    }).then( this.proxy( function( fragment ) {
      this.element.append( fragment );
    }));
  }

});</pre>
      </section>

      <section id="s5">
        <h2>What is itâ€½</h2>
        <ul>
          <li>
            Live binding is an extension of the Observable Pattern that 
            automatically binds data changes to view updates.
          </li>
          <li>
            Call render once! Abstracts away view updating code.
          </li>
        </ul>

      </section>

      <section class="center">
        <h2>Implementing Live Binding Correctly</h2>
        <ul>
          <li>
            The goal is to <b>not</b> to simply re-render the entire template 
            after each update to the <code>data</code>.
          </li>
          <li>
            The larger and more complex your template is, the more the browser
            has to reflow/repaint.
          </li>
          <li>
            If you're only updating a single property, why re-render the <b>entire</b> 
            view? Only re-render what has changed.
          </li>
        </ul>
      </section>


      <section>
        <h2>Implementing Live Binding in EJS</h2>
        <ul>
          <li>
            EJS wraps all statements in <code>function</code>s. So the following
            statement:
            <div style="font-size: 70%">
              <pre class="brush: js">&lt;%= user.attr("location") %&gt;</pre>
            </div>
          </li>
          <li>
            Becomes...
            <div style="font-size: 70%">
              <pre class="brush: js">function() { return user.attr("location"); }</pre>
            </div>
          </li>
        </ul>
      </section>

      <section>
        <h2>Implementing Live Binding in EJS</h2>
        <ul>
          <li>
            Determine if there are any <code>Observable</code>s referenced from
            within the template. 
            <div style="font-size: 70%">
              <pre class="brush: js">&lt;%= user.attr("location") %&gt;</pre>
            </div>
          </li>
          <li>
            Bind that <code>function</code> to changes to the <code>Observable</code>.
          </li>
          <li>
            On <code>change</code>, re-run the <code>function</code> and replace
            the corresponding fragment with the result.
          </li>
        </ul>

      </section>

      <section>
        <h2>Three cases to consider</h2>
        <ul>
          <li>Text</li>
        </ul>
        <pre class="brush: js">&lt;%=user.attr("name")%&gt;</pre>
        <ul>
          <li>HTML</li>
        </ul>
        <pre class="brush: js">&lt;div&gt;&lt;%=user.attr("name")%>&lt;/div&gt;</pre>
        <ul>
          <li>Attributes</li>
        </ul>
        <div style="font-size: 85%">
          <pre class="brush: html">&lt;span&lt;% if( user.attr("location") == "TX" { %&gt; class="yehaw"&lt;% } %&gt;</pre>
        </div>
      </section>

      <section>
        <h2>Handling Attributes</h2>
        <ul>
          <li>
            The Problem
            <div style="font-size: 50%">
              <pre class="brush: html">&lt;span&lt;% if( user.attr("location") == "TX" { %&gt; class="yehaw"&lt;% } %&gt;</pre>
            </div>
          </li>
          <li>Determine the name of the attribute being set.</li>
          <li>Cycle through the attributes looking for a match, and update.</li>
        </ul>
      </section>

      <section>
        <h2>Getting it to work in IE6+</h2>
        <li>Tag map
<div style="font-size: 80%">
<pre class="brush: js">var tagMap = {
  ""    : "span", 
  table : "tr", 
  tr    : "td", 
  ol    : "li", 
  ul    : "li", 
  tbody : "tr",
  thead : "tr",
  tfoot : "tr"
};</pre>
</div>
      </section>

      <section>
        <h2>Contact Information</h2>
        <ul>
          <li>Emails at ralph [at] bitovi [dot] com</li>
          <li>Twitter <a target="_blank" href="http://twitter.com/ralphholzmann">@ralphholzmann</a></li>
          <li>ralphholzmann on freenode</li>
          <li><code>/join</code> <code>#jquery</code>, <code>#yepnope</code>, <code>#html5</code></li>
        </ul>
      </section>

    </div>
    

    <link rel=stylesheet href=syntaxhighlighter/styles/shCore.css />
    <link rel=stylesheet href=syntaxhighlighter/styles/shThemeEclipse.css />
    <script src=syntaxhighlighter/scripts/shCore.js></script>
    <script src=syntaxhighlighter/scripts/shAutoloader.js></script>
    <script src=javascript/jquery-1.7.2.min.js></script>
    <script src=javascript/slides.js></script>
  </body>
</html>
